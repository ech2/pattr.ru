---
layout:     blogpost
title:      "Принцип Цикады в Музыке или Магия Простых Чисел"
date:       2011-11-06 02:39:24
categories: blog
author:     "OSCII"
permalink:  /cicada-principle-in-music.html
alias:      /blog/princip-cikady-v-muzyke-ili-magiya-prostyh-chisel-na-primere-puredata
attach:     pureadata-cicada-music.zip
---

<p>Прочитав замечательную <a href="http://habrahabr.ru/blogs/css/117160/"
                             title="Принцип цикады и почему он важен для веб дизайна">статью</a> на хабре об
  использовании простых чисел для создания не повторяющегося фона, я подумал, почему бы не реализовать подобное для
  генерации музыки? Поразмыслив, я решил реализовать все следующим образом.</p>

<p>Будет создано несколько сообщений, содержащих последовательность из нулей и единиц. По сигналу из метронома из
  каждого сообщения будет извлекаться один
  единственный элемент, после чего все элементы будут суммированы. Количество элементов в сообщении будет разное, и
  будет представлять простое число. На выходе будет ожидаться целое
  число от нуля до <em>%количество_сообщений%</em>, которое замапится на определенную ноту.</p>

<h2>Почему PureData?</h2>


<p>Объективных причин нет, зато есть две субъективные:

<ul>
  <li>у меня под рукой только слабенький нетбук, на который не хотелось бы ставить демо версию макса;</li>
  <li>кое-кто недавно назвал <a href="http://pattr.ru">pattr.ru</a> сайтом о <em>Max/MSP</em>, что не совсем верно,
    просто <em>Max </em>— наиболее удобный инструмент для меня лично.
  </li>
</ul>

<p>По сути, <em>PureData </em>и<em> Max/MSP</em> имеют одинаковые возможности в плане звука, просто <em>Pd</em>, ввиду
  своей открытости, сильно сливает максу по юзабилити.</p>

<h2>Patch me if you can</h2>

<p>Для начала нам нужно собрать алгоритм, который будет последовательно считывать атомы из сообщения (атом — это базовая
  единица в <em>Pd</em>, наше сообщение состоит из нескольких атомов). Для <em>PureData </em>сделана библиотека <a
      href="http://puredata.info/community/projects/software/cyclone" title="Библиотека для PureData">Cyclone</a>, в
  которой портированы многие Max/MSP объекты, так что просто возьмем кусок патча из предыдущей <a
      href="http://pattr.ru/content/articles/delaem-step-sekvensor-s-pomoshchyu-max4live"
      title="Делаем степ-секвенсор с помощью Max4Live">статьи </a>и пересоберем его в
  <em>Pd </em><em>(counter-list.pd)</em>.</p>

<p><img src="http://pattr.ru/img/cicada-test/counter-list.png" alt="Извлекаем атом из сообщения PureData"/></p>

<p>В этом патче мы имеем сообщение, содержащее семь атомов, счетчик, который считает от <em>1 </em>до <em>7</em>, и
  объект <strong>[zl nth]</strong>, который извлекает определенный атом из входящего сообщения. Обратите внимание, что
  число из счетчика направляется в объект <strong>[t b i]</strong>. Он сначала подает число в правый инлет <strong>[zl
    nth]</strong>, тем самым говоря объекту номер атома для извлечения, а затем подает <em>BANG </em>в сообщение,
  заставляя его вывести свое содержимое. В итоге получаем, что при нажатии на кнопку, будет последовательно выводиться
  один атом за другим.</p>

<p>Теперь продублируем это все несколько раз и соберем следующее:</p>

<p><img src="http://pattr.ru/img/cicada-test/result.png"
        alt="Готовый генератор мелодий на основе простых чисел PureData"/></p>

<p>Как видно, извлеченные атомы складываются объектом <strong>expr</strong>, в нашем случае сумма будет колебаться в
  диапазоне <em>0...5</em>. Объект <strong>sel </strong>зависимости от результата суммирования триггерит одно из пяти
  чисел, представляющих собой номера нот, которые далее подаются в синтезатор. Номера нот взяты не с потолка — это
  пентатонический звукоряд, то есть данном патче играют только «черные» клавиши пианино. На устройстве синта не буду
  останавливаться, это простой синусоидный синт с четырехголосной полифонией.</p>

<h2>Заключение</h2>

<p>Этот простой патч был создан ради эксперимента, мне хотелось попробовать применить принцип цикады для генерации
  паттернов. Как видно, результат получился интересным: чувствуется определенная повторяемость мелодии, но четких границ
  лупа не слышно (еще бы, у нас получилась секвенция, длиной
    <code>3&nbsp;*&nbsp;5&nbsp;*&nbsp;7&nbsp;*&nbsp;11&nbsp;*&nbsp;17&nbsp;=&nbsp;19635</code>&nbsp;шагов).
    Можно сказать, что мой арсенал алгоритмических тулз пополнился еще одной.
    Спасибо, Хабр!</p>

<p>Для тех, у кого под рукой нет Pd, я записал результат в файл:
  <a href="http://pattr.ru/img/cicada-test/cicada.mp3">http://pattr.ru/img/cicada-test/cicada.mp3</a></p>