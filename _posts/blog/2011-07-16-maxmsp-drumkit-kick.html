---
layout: blogpost
title:  "Синтез ударных в Max/MSP. Часть 1: бочка"
date:   2011-07-16 15:43:07
categories: blog
author: "OSCII"
permalink: /drum-synthesis-in-maxmsp-kick.html
alias: /blog/chast-1-bochka
---

<p>
  Любой музыкант музыкант рано или поздно начинает задумываться о том, чтобы синтезировать свои собственные бочки,
  снейры или перкуссии. Некоторым просто любопытно, как это все это работает, другими же двигает бесконечное стремление
  сделать что-то свое, так или иначе, все хотят создать свой уникальный звук.

<p>Сразу хочется сказать, что создать что-то
  совершенно уникальное очень сложно, все-таки саунд дизайн существует не один десяток лет, а многочисленные библиотеки
  сэмплов наверняка уже имеют нужную вам бочку или снейр. Отсюда возникает логичный вопрос: зачем вообще обычному
  музыканту париться с синтезом ударных, если можно просто взять сэмпл из библиотеки? Дело в том, что когда точно
  знаешь, какой звук нужен, гораздо проще и быстрее накрутить его самому, чем перебрать сотни вавок, к тому же в
  последствии все равно придется подгонять выбранный сэмпл под текущий трек (по питчу, по длине и тд).</p>
<p>
  Эта большая тема, поэтому она будет разделена на несколько постов. Что ж начнем&hellip;</p>

<h2>
  Бочка</h2>
<p>
  Ну это вообще попса :) Чуть менее, чем все музыканты-электронщики знают, что электронная бочка &mdash; это
  промодулированная по частоте синусоида. Щелчок получается засчет быстрого спада частоты генератора в первые моменты
  звука, а тело образуется, когда частота либо перестает спадать, либо падает, но медленно.</p>
<p>
  Но для того, чтобы приготовить кошерную бочку недостаточно одной только модуляции частоты: нам еще понадобится
  огибающая (envelope) для амплитуды. Действительно, звук, амплитуда которого не меняется со временем звучит уныло и
  плохо сидит в миксе.</p>
<p>
  Итак, для начала определимся с основными объектами, вокруг которых мы будем строить патч: <b>cycle~</b> - это наша
  синусоида, основа бочки; <b>function</b>, <b>line~</b> - эти два объекта будут генерировать огибающие для частоты и
  амплитуды. Можно, в принципе, использовать и <b>adsr~</b>, он проще в настройке, но менее гибкий, потому мы его и не
  взяли.</p>
<p>
  Разумеется, это не все объекты, которые будут использоваться, просто остальные мы будем подстраивать именно под
  них.</p>
<p>
  Теперь о том, как работают некоторые объекты.</p>
<p>
  <b>cycle~</b>, как уже говорилось, генерирует синусоиду (точнее, косинусоиду, но это не столь важно). Этот объект
  может иметь аргумент, который определяет частоту звука, генерируемого объектом по умолчанию, когда не подан сигнал в
  первый вход. Объект имеет два входа: первый для модуляции частоты, второй для модуляции фазы (фаза нормализирована до
  диапазона <i>0&hellip;1</i>, тем, кто не помнит тригонометрию напомню, что один цикл косинуса занимает диапазон <i>0&hellip;2&pi;</i>).
</p>
<p>
  Объект <i>line~</i> генерирует рамповидный сигнал. Объясним, что это такое на примере. Допустим, мы хотим создать
  огибающую, которая будет стартовать с нуля, затем за полсекунды достичь единицы, после чего за сто миллисекунд
  опуститься до <i>0.5</i>. Чтобы сгенерировать такую рампу, надо послать сообщение в объект вида <i>(0, 1&nbsp;500&nbsp;0.5&nbsp;100)</i>.
  Разберем, что оно означают все эти цифры. Ноль, после которого стоит запятая мгновенно возвращает рампу в нулевое
  значение; следующая пара цифр <i>1&nbsp;500</i> означает, что рампа поднимется до единицы за <i>500 мс</i>; после
  того, как рампа поднимется до <i>1</i>, вторая пара<i> 0.5&nbsp;100</i> опускает рампу до <i>0.5</i> за <i>100 мс</i>.
</p>
<p>
  Таким способом не слишком удобно задавать огибающие (хотя, при определенной тренировке, не составит особого труда
  прописывать несложные энвелопы). Программисты из <b>Cycling&rsquo;74</b> решили эту проблему, создав объект <b>function</b>.
  В нем мы вручную рисуем нужную нам огибающую, после чего в левый вход подаем <i>BANG</i>, а объект выводит из второго
  слева выхода готовое сообщение для <b>line~</b>.</p>
<p>
  Так, мы отклонились от темы, нам надо определиться, как нужно моделировать частоту. Простой вариант: просто умножить
  созданную в <b>line~</b> огибающую с диапазоном <i>1&hellip;0</i> на некоторую величину, которая будет регулировать
  глубину модуляции. У этого способа есть недостаток &mdash; он не позволяет регулировать базовую частоту бочки, то есть
  ее частота всегда будет падать до нуля, что не есть гуд. Почему? Дело в том, что тональность бочки нужно подстраивать
  под тональность всего трека, чтобы не создавалось ощущение, что &laquo;бочка не та&raquo;. В общем, чтобы иметь
  возможность регулировать базовую частоту нам нужно всего лишь прибавить к уже умноженному сигналу модуляции значение
  базовой частоты.</p>
<p>
  Вот результат <i>(kick1.maxpat)</i>. Нажмите на большую кнопку, чтобы услышать звук.</p>
<p>
  <img alt="" src="https://cloud.githubusercontent.com/assets/1007225/4955722/551a7532-6697-11e4-89c5-08e0d6349dd2.png" style="width: 458px; height: 526px;"/></p>
<p>
  Уже похоже на бочку, не правда ли? Но ей определенно нужна огибающая громкости. Для ее создания мы будем использовать
  пару из объектов <b>function </b>и <b>line~</b>. Выход из <b>line~</b> нужно перемножить с сигналом, выходящим из <b>cycle~</b>
  (kick2.maxpat).</p>
<p>
  <img alt="" src="https://cloud.githubusercontent.com/assets/1007225/4955723/551c2e40-6697-11e4-885a-787c3e59aa7d.png" style="width: 549px; height: 524px;"/></p>
<p>
  Вот и все. Я обычно умножаю выход огибающей на саму себя, чтобы она изменялась экспоненциально. Вот окончательная
  версия патча <i>(kick3.maxpat)</i>:</p>
<p>
  <img alt="" src="https://cloud.githubusercontent.com/assets/1007225/4955724/5520719e-6697-11e4-82eb-8b80916c92f0.png" style="width: 521px; height: 514px;"/></p>
<p>
  В следующей статье мы будем создавать снейры и, может быть, что-нибудь еще, посмотрим :)</p>
<h2>
  Дополнение</h2>
<p>
  По просьбе одного читателя, выкладываю версию патча, созданного в PureData. Принципиальных отличий от максовского
  патча не имеет, разве что вместо объекта <b>function </b>используется <b>envgen</b>, а вместо объект <b>cycle~</b>
  заменяется <b>osc~</b>. Ну и, разумеется, стандартные недостатки пд в виде сброса всех настроек и отсутствия подобия
  объекта preset.</p>
<p>
  <img alt="" src="https://cloud.githubusercontent.com/assets/1007225/4955721/5518b8f0-6697-11e4-86af-b9b621f37e62.png" style="width: 691px; height: 543px;"/></p>


