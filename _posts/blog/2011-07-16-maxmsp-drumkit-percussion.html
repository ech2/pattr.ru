---
layout: blogpost
title:  "Синтез Ударных в Max/MSP. Часть 4: Перкуссии"
date:   2011-07-16 18:50:04
categories: blog
author: "OSCII"
permalink: /drum-synthesis-in-maxmsp-percussion.html
alias: /blog/chast-4-perkussii
attach: maxmsp-drumsynth-percussion.zip
---

<p>
  Задача перкуссий &ndash; создать ритмическую картину. Если кик со снейром задают основной ритм, то перкуссии создают
  то, что мы называем грувом. Они звучат не на основном плане и часто используют более высокие частоты, чем кик или
  снейр.</p>
<p>
  По сути, в роли перкуссий можно использовать огромное множество звуков, главное, чтобы они имели явную атаку. Отличный
  способ синтезировать перкуссии &ndash; использовать <i>FM</i> или <i>AM</i> синтез, однако в прошлой статье мы
  разобрали эти виды синтеза, поэтому не будем повторяться и оставим это читателям на самостоятельные эксперименты.</p>

<h2>
  Импульс и фильтр</h2>
<p>
  Многие знают, что если поставить у фильтра большое значение резонанса, то будет перегрузка звука. Не буду вдаваться в
  детали, почему это происходит (так как описание работы фильтра &ndash; это тема для отдельной статьи), скажу лишь, что
  чем больше резонанс, тем больше время реакции фильтра. Это свойство можно использовать и для извлечения звука, если
  подать на вход фильтра один лишь импульс.</p>
<p>
  <img alt="" src="/img/drumkit_synthesis/perc/impulse-responce.png"/></p>
<p>
  На верхнем рисунке виден сам импульс, а на нижнем &ndash; ответ фильтра на входящий в него импульс (думаю, многие
  слышали об <i>impulse response</i>). Как видно, фильтр при высоком заданном резонансе производит затухающие осцилляции
  в ответ на входящий импульс. Частота осцилляции равна частоте среза фильтра, а количество колебаний зависит от
  резонанса (чем выше резонанс, тем больше осцилляций создаст фильтр). Не смущайтейсь из-за квадратной волны на нижней
  картинке &ndash; это из-за того, что объект <b>scope~</b>, с помощью которого снимался сигнал, имеет маленькое
  разрешение, на самом деле сигнал представляет собой синусоиду.</p>
<p>
  Так, теории хватит, можно собирать патч. За генерацию импульса будет отвечать объект <b>click~</b>, он генерирует
  импульс в ответ на поступивший в него <i>bang</i>. В качестве фильтра будем использовать
  <strong>reson~</strong> &ndash; это резонансный <i>bandpass</i> фильтр. У него четыре входа: первый &ndash; для
  сигнала, который будет фильтроваться, второй будет регулировать усиление сигнала <i>(gain)</i>, третий &ndash; срез
  фильтра <i>(cutoff)</i>, четвертый &ndash; резонанс. Все эти параметры можно задавать и через аргументы, их может быть
  три, соответственно <i>gain</i>, <i>cutoff</i> и <i>resonance</i>.</p>
<p>
  В следующем патче <i>(perc1.maxpat)</i> представлен этот алгоритм. Хочу обратить внимание, что в данном патче параметр
  резонанса также регулирует и <i>gain</i>. Это сделано в связи с тем, что при увеличении резонанса уменьшается
  амплитуда сигнала, поэтому ее нужно постоянно корректировать. Я заметил, что если значение gain в три раза больше
  значения резонанса, то максимальная амплитуда осцилляций находится почти на единице.</p>
<p>
  <img alt="" src="/img/drumkit_synthesis/perc/res-body.png"/></p>
<p>
  Покрутите параметры патча и проследите за тем, как изменяется звук.</p>
<p>
  Теперь увеличим количество фильтров до трех и настроим их параметры <i>(perc2.maxpat)</i>.</p>
<p>
  <img alt="" src="/img/drumkit_synthesis/perc/res-bodies.png"/></p>
<p>
  Ну здесь ничего сложного, три параллельных фильтра с разными параметрами. Стоит отметить только объект
  <b>omx.peaklim~</b> &ndash; это обычный лимитер, который не позволяет сигналу выходить за рамки <i>-1&hellip;1</i>, но
  отличие от <b>clip~</b>, он не искажает сигнал. Он включен в патч, чтобы читатели, экспериментируя, не испортили уши
  от сильных перегрузок, которые могут возникнуть при очень большом резонансе (соответственно при большой длине
  осцилляции), так что будьте осторожны.</p>
<h2>
  Все!</h2>
<p>
  Наконец, написана последняя статья из серии по синтезу ударных. Надеюсь, эти статьи помогут в изучении макса и
  синтеза. В следующей статье мы с Брюсом будем описывать создание простенького субтрактивного синта с полифонией в <b>PureData</b>.
</p>
